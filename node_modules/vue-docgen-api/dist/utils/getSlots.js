"use strict";var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports, "__esModule", { value: true });exports.default = getSlots;var _htmlparser = _interopRequireDefault(require("htmlparser2"));

var HtmlParser = _htmlparser.default.Parser;
var lex = require('pug-lexer');
var parse = require('pug-parser');
var wrap = require('pug-runtime/wrap');
var generateCode = require('pug-code-gen');

function getSlots(parts) {
  var output = {};
  if (parts.template && parts.template.content) {
    var template = parts.template.content;
    var lastComment = '';

    if (parts.template.attrs.lang === 'pug') {
      var funcStr = generateCode(parse(lex(parts.template.content)), {
        compileDebug: false,
        pretty: true,
        inlineRuntimeFunctions: false,
        templateName: '_parse' });

      var func = wrap(funcStr, '_parse');
      template = func();
    }

    var parser = new HtmlParser({
      oncomment: function oncomment(data) {
        if (data.search(/\@slot/) !== -1) {
          lastComment = data.replace('@slot', '').trim();
        }
      },
      ontext: function ontext(text) {
        if (text.trim()) {
          lastComment = '';
        }
      },
      onopentag: function onopentag(name, attrs) {
        if (name === 'slot') {
          var nameSlot = attrs.name || 'default';
          output[nameSlot] = {
            description: lastComment };


          lastComment = '';
        }
      } });


    parser.write(template);
    parser.end();
    return output;
  }
  return {};
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy91dGlscy9nZXRTbG90cy5qcyJdLCJuYW1lcyI6WyJIdG1sUGFyc2VyIiwiaHRtbHBhcnNlcjIiLCJQYXJzZXIiLCJsZXgiLCJyZXF1aXJlIiwicGFyc2UiLCJ3cmFwIiwiZ2VuZXJhdGVDb2RlIiwiZ2V0U2xvdHMiLCJwYXJ0cyIsIm91dHB1dCIsInRlbXBsYXRlIiwiY29udGVudCIsImxhc3RDb21tZW50IiwiYXR0cnMiLCJsYW5nIiwiZnVuY1N0ciIsImNvbXBpbGVEZWJ1ZyIsInByZXR0eSIsImlubGluZVJ1bnRpbWVGdW5jdGlvbnMiLCJ0ZW1wbGF0ZU5hbWUiLCJmdW5jIiwicGFyc2VyIiwib25jb21tZW50IiwiZGF0YSIsInNlYXJjaCIsInJlcGxhY2UiLCJ0cmltIiwib250ZXh0IiwidGV4dCIsIm9ub3BlbnRhZyIsIm5hbWUiLCJuYW1lU2xvdCIsImRlc2NyaXB0aW9uIiwid3JpdGUiLCJlbmQiXSwibWFwcGluZ3MiOiIyTEFBQTs7QUFFQSxJQUFNQSxVQUFVLEdBQUdDLG9CQUFZQyxNQUEvQjtBQUNBLElBQU1DLEdBQUcsR0FBR0MsT0FBTyxDQUFDLFdBQUQsQ0FBbkI7QUFDQSxJQUFNQyxLQUFLLEdBQUdELE9BQU8sQ0FBQyxZQUFELENBQXJCO0FBQ0EsSUFBTUUsSUFBSSxHQUFHRixPQUFPLENBQUMsa0JBQUQsQ0FBcEI7QUFDQSxJQUFNRyxZQUFZLEdBQUdILE9BQU8sQ0FBQyxjQUFELENBQTVCOztBQUVlLFNBQVNJLFFBQVQsQ0FBa0JDLEtBQWxCLEVBQXlCO0FBQ3RDLE1BQU1DLE1BQU0sR0FBRyxFQUFmO0FBQ0EsTUFBSUQsS0FBSyxDQUFDRSxRQUFOLElBQWtCRixLQUFLLENBQUNFLFFBQU4sQ0FBZUMsT0FBckMsRUFBOEM7QUFDNUMsUUFBSUQsUUFBUSxHQUFHRixLQUFLLENBQUNFLFFBQU4sQ0FBZUMsT0FBOUI7QUFDQSxRQUFJQyxXQUFXLEdBQUcsRUFBbEI7O0FBRUEsUUFBR0osS0FBSyxDQUFDRSxRQUFOLENBQWVHLEtBQWYsQ0FBcUJDLElBQXJCLEtBQThCLEtBQWpDLEVBQXdDO0FBQ3BDLFVBQU1DLE9BQU8sR0FBR1QsWUFBWSxDQUFDRixLQUFLLENBQUNGLEdBQUcsQ0FBQ00sS0FBSyxDQUFDRSxRQUFOLENBQWVDLE9BQWhCLENBQUosQ0FBTixFQUFxQztBQUMvREssUUFBQUEsWUFBWSxFQUFFLEtBRGlEO0FBRS9EQyxRQUFBQSxNQUFNLEVBQUUsSUFGdUQ7QUFHL0RDLFFBQUFBLHNCQUFzQixFQUFFLEtBSHVDO0FBSS9EQyxRQUFBQSxZQUFZLEVBQUUsUUFKaUQsRUFBckMsQ0FBNUI7O0FBTUEsVUFBTUMsSUFBSSxHQUFHZixJQUFJLENBQUNVLE9BQUQsRUFBVSxRQUFWLENBQWpCO0FBQ0FMLE1BQUFBLFFBQVEsR0FBR1UsSUFBSSxFQUFmO0FBQ0g7O0FBRUQsUUFBTUMsTUFBTSxHQUFHLElBQUl0QixVQUFKLENBQWU7QUFDNUJ1QixNQUFBQSxTQUFTLEVBQUUsbUJBQUFDLElBQUksRUFBSTtBQUNqQixZQUFJQSxJQUFJLENBQUNDLE1BQUwsQ0FBWSxRQUFaLE1BQTBCLENBQUMsQ0FBL0IsRUFBa0M7QUFDaENaLFVBQUFBLFdBQVcsR0FBR1csSUFBSSxDQUFDRSxPQUFMLENBQWEsT0FBYixFQUFzQixFQUF0QixFQUEwQkMsSUFBMUIsRUFBZDtBQUNEO0FBQ0YsT0FMMkI7QUFNNUJDLE1BQUFBLE1BQU0sRUFBRSxnQkFBQUMsSUFBSSxFQUFJO0FBQ2QsWUFBSUEsSUFBSSxDQUFDRixJQUFMLEVBQUosRUFBaUI7QUFDZmQsVUFBQUEsV0FBVyxHQUFHLEVBQWQ7QUFDRDtBQUNGLE9BVjJCO0FBVzVCaUIsTUFBQUEsU0FBUyxFQUFFLG1CQUFDQyxJQUFELEVBQU9qQixLQUFQLEVBQWlCO0FBQzFCLFlBQUlpQixJQUFJLEtBQUssTUFBYixFQUFxQjtBQUNuQixjQUFNQyxRQUFRLEdBQUdsQixLQUFLLENBQUNpQixJQUFOLElBQWMsU0FBL0I7QUFDQXJCLFVBQUFBLE1BQU0sQ0FBQ3NCLFFBQUQsQ0FBTixHQUFtQjtBQUNqQkMsWUFBQUEsV0FBVyxFQUFFcEIsV0FESSxFQUFuQjs7O0FBSUFBLFVBQUFBLFdBQVcsR0FBRyxFQUFkO0FBQ0Q7QUFDRixPQXBCMkIsRUFBZixDQUFmOzs7QUF1QkFTLElBQUFBLE1BQU0sQ0FBQ1ksS0FBUCxDQUFhdkIsUUFBYjtBQUNBVyxJQUFBQSxNQUFNLENBQUNhLEdBQVA7QUFDQSxXQUFPekIsTUFBUDtBQUNEO0FBQ0QsU0FBTyxFQUFQO0FBQ0QiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgaHRtbHBhcnNlcjIgZnJvbSAnaHRtbHBhcnNlcjInXG5cbmNvbnN0IEh0bWxQYXJzZXIgPSBodG1scGFyc2VyMi5QYXJzZXJcbmNvbnN0IGxleCA9IHJlcXVpcmUoJ3B1Zy1sZXhlcicpO1xuY29uc3QgcGFyc2UgPSByZXF1aXJlKCdwdWctcGFyc2VyJyk7XG5jb25zdCB3cmFwID0gcmVxdWlyZSgncHVnLXJ1bnRpbWUvd3JhcCcpO1xuY29uc3QgZ2VuZXJhdGVDb2RlID0gcmVxdWlyZSgncHVnLWNvZGUtZ2VuJyk7XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldFNsb3RzKHBhcnRzKSB7XG4gIGNvbnN0IG91dHB1dCA9IHt9XG4gIGlmIChwYXJ0cy50ZW1wbGF0ZSAmJiBwYXJ0cy50ZW1wbGF0ZS5jb250ZW50KSB7XG4gICAgbGV0IHRlbXBsYXRlID0gcGFydHMudGVtcGxhdGUuY29udGVudFxuICAgIGxldCBsYXN0Q29tbWVudCA9ICcnXG5cbiAgICBpZihwYXJ0cy50ZW1wbGF0ZS5hdHRycy5sYW5nID09PSAncHVnJykge1xuICAgICAgICBjb25zdCBmdW5jU3RyID0gZ2VuZXJhdGVDb2RlKHBhcnNlKGxleChwYXJ0cy50ZW1wbGF0ZS5jb250ZW50KSksIHtcbiAgICAgICAgICBjb21waWxlRGVidWc6IGZhbHNlLFxuICAgICAgICAgIHByZXR0eTogdHJ1ZSxcbiAgICAgICAgICBpbmxpbmVSdW50aW1lRnVuY3Rpb25zOiBmYWxzZSxcbiAgICAgICAgICB0ZW1wbGF0ZU5hbWU6ICdfcGFyc2UnLFxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgZnVuYyA9IHdyYXAoZnVuY1N0ciwgJ19wYXJzZScpO1xuICAgICAgICB0ZW1wbGF0ZSA9IGZ1bmMoKTtcbiAgICB9XG5cbiAgICBjb25zdCBwYXJzZXIgPSBuZXcgSHRtbFBhcnNlcih7XG4gICAgICBvbmNvbW1lbnQ6IGRhdGEgPT4ge1xuICAgICAgICBpZiAoZGF0YS5zZWFyY2goL1xcQHNsb3QvKSAhPT0gLTEpIHtcbiAgICAgICAgICBsYXN0Q29tbWVudCA9IGRhdGEucmVwbGFjZSgnQHNsb3QnLCAnJykudHJpbSgpXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBvbnRleHQ6IHRleHQgPT4ge1xuICAgICAgICBpZiAodGV4dC50cmltKCkpIHtcbiAgICAgICAgICBsYXN0Q29tbWVudCA9ICcnXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBvbm9wZW50YWc6IChuYW1lLCBhdHRycykgPT4ge1xuICAgICAgICBpZiAobmFtZSA9PT0gJ3Nsb3QnKSB7XG4gICAgICAgICAgY29uc3QgbmFtZVNsb3QgPSBhdHRycy5uYW1lIHx8ICdkZWZhdWx0J1xuICAgICAgICAgIG91dHB1dFtuYW1lU2xvdF0gPSB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogbGFzdENvbW1lbnQsXG4gICAgICAgICAgfVxuXG4gICAgICAgICAgbGFzdENvbW1lbnQgPSAnJ1xuICAgICAgICB9XG4gICAgICB9LFxuICAgIH0pXG5cbiAgICBwYXJzZXIud3JpdGUodGVtcGxhdGUpXG4gICAgcGFyc2VyLmVuZCgpXG4gICAgcmV0dXJuIG91dHB1dFxuICB9XG4gIHJldHVybiB7fVxufVxuIl19